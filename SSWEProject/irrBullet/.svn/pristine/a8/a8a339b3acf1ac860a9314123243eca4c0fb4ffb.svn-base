#include "collisionobjectaffectordelete.h"
#include "bulletworld.h"
#include "collisionobject.h"
#include <vector3d.h>

ICollisionObjectAffectorDelete::ICollisionObjectAffectorDelete(irr::u32 delay, bool remNode)
{
    EndTime = 0;
    TimeDelay = delay;
    HasFinished = false;
    FirstRun = true;
    RemoveNode = remNode;
}

void ICollisionObjectAffectorDelete::affectObject(ICollisionObject* object, irr::u32 timeMS)
{
    if(FirstRun == true)
    {
        EndTime = timeMS + TimeDelay;
        FirstRun = false;
    }

    else
    if(timeMS >= EndTime)
    {
        HasFinished = true;

        if(RemoveNode)
            object->getCollisionShape()->getSceneNode()->remove();

        object->getDynamicsWorld()->addToDeletionQueue(object);
    }
}

ICollisionObjectAffectorDelete::~ICollisionObjectAffectorDelete()
{
    //dtor
}
